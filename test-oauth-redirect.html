<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth Redirect Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .url-display {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            word-break: break-all;
            margin: 10px 0;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>OAuth Redirect Test</h1>
        <p>This page helps test the OAuth redirect functionality.</p>

        <div class="test-section">
            <h3>Test 1: Simulate OAuth Callback with Code</h3>
            <p>This simulates what happens when OAuth redirects to localhost with a code:</p>
            <button class="test-button" onclick="testOAuthCallback()">Test OAuth Callback</button>
            <div id="test1-result"></div>
        </div>

        <div class="test-section">
            <h3>Test 2: Check Current Environment</h3>
            <button class="test-button" onclick="checkEnvironment()">Check Environment</button>
            <div id="test2-result"></div>
        </div>

        <div class="test-section">
            <h3>Test 3: Direct Vercel Redirect</h3>
            <button class="test-button" onclick="redirectToVercel()">Go to Vercel App</button>
            <div id="test3-result"></div>
        </div>

        <div class="test-section">
            <h3>Current URL Information</h3>
            <div class="url-display" id="current-url"></div>
            <div id="url-analysis"></div>
        </div>
    </div>

    <script>
        // Display current URL
        document.getElementById('current-url').textContent = window.location.href;
        
        // Analyze current URL
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const state = urlParams.get('state');
        const error = urlParams.get('error');
        
        let analysis = '<div class="status info">';
        analysis += '<strong>URL Analysis:</strong><br>';
        analysis += `Hostname: ${window.location.hostname}<br>`;
        analysis += `Protocol: ${window.location.protocol}<br>`;
        analysis += `Code: ${code || 'None'}<br>`;
        analysis += `State: ${state || 'None'}<br>`;
        analysis += `Error: ${error || 'None'}<br>`;
        analysis += '</div>';
        
        document.getElementById('url-analysis').innerHTML = analysis;

        function testOAuthCallback() {
            const testCode = 'test-code-12345';
            const testState = 'test-state-67890';
            const testUrl = `http://localhost:3000/authPage?code=${testCode}&state=${testState}`;
            
            document.getElementById('test1-result').innerHTML = 
                '<div class="status info">Simulating OAuth callback...<br>' +
                '<div class="url-display">' + testUrl + '</div>' +
                'This would normally redirect to: <br>' +
                '<div class="url-display">https://projectmngnt.vercel.app/authPage?code=' + testCode + '&state=' + testState + '</div>' +
                '</div>';
        }

        function checkEnvironment() {
            const env = {
                hostname: window.location.hostname,
                protocol: window.location.protocol,
                href: window.location.href,
                isLocalhost: window.location.hostname === 'localhost',
                isVercel: window.location.hostname.includes('vercel.app'),
                userAgent: navigator.userAgent
            };
            
            let result = '<div class="status info"><strong>Environment Check:</strong><br>';
            for (const [key, value] of Object.entries(env)) {
                result += `${key}: ${value}<br>`;
            }
            result += '</div>';
            
            document.getElementById('test2-result').innerHTML = result;
        }

        function redirectToVercel() {
            document.getElementById('test3-result').innerHTML = 
                '<div class="status success">Redirecting to Vercel app...</div>';
            
            setTimeout(() => {
                window.location.href = 'https://projectmngnt.vercel.app/authPage';
            }, 1000);
        }

        // Auto-check environment on load
        checkEnvironment();
    </script>
</body>
</html>
